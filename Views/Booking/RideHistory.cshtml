@model List<HomeworkAssignment1.Models.Booking>

@{
    ViewBag.Title = "Ride History";
}

<h2>Ride History</h2>

<div id="rideHistory"></div>

@section scripts {
    <script>
        $(document).ready(function () {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const $historyContainer = $('#rideHistory');

            if (bookings.length === 0) {
                $historyContainer.html('<p>No bookings found</p>');
                return;
            }

            let html = '';
            bookings.forEach(booking => {
                html += `
                        <div class="card mb-3 ${booking.isEmergency ? 'border-danger' : ''}">
                            <div class="card-body">
                                <h5>${new Date(booking.bookingDate).toLocaleDateString()} ${booking.isEmergency ? ' - S.O.S' : ''}</h5>
                                <p><strong>Booking ID:</strong> ${booking.bookingID}</p>
                                <p><strong>Driver:</strong> ${booking.driver?.driverFirstName} ${booking.driver?.driverLastName}</p>
                                <p><strong>Ambulance:</strong> ${booking.vehicle?.vehicleType}</p>
                                <p><strong>Pick-Up:</strong> ${booking.bookingPickupAddress}</p>
                                <button class="btn btn-info view-booking" data-id="${booking.bookingID}">View Details</button>
                            </div>
                        </div>
                    `;
            });

            $historyContainer.html(html);
        });
    </script>
}
